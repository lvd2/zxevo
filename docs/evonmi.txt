Магик на пентеве.


1. ВВодится состояние NMI. Отличается тем, что в очко #0000-#3FFF принудительно
включается последняя (255ая) страница ОЗУ.

Вход в состояние NMI происходит, собственно, по началу сигнала /NMI на
процессор.

При этом, вход не гарантируется и может привести к катастрофе, если /MNI
приходит во время команды, которая:
1) имеет стек области #0000-#3FFF
2) исполняется из области #0000-#3FFF
3) использует данные в области #0000-#3FFF
В случаях 1 и 3 может нарушиться целостность данных в последней странице ОЗУ.


2. предлагается ввести порт #BE (чтение-запись).

на чтение - можно будет считать состояние портов #7FFD, #EFF7, состояние менеджера памяти.
Что читаем - определяется старшим адресным байтом. Конкретный формат пока не
определён.

на запись - после факта записи в этот порт, если находимся в состоянии NMI, на
2ой по счёту /RFSH выключаем это состояние.

Таким образом выход из NMI происходит так

  POP <все регистры>
  OUT (#BE),A
  RETN

